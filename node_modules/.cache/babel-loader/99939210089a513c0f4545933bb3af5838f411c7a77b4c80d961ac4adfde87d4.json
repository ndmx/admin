{"ast":null,"code":"import { useRef } from \"react\";\nimport { addDoc, collection, get } from \"firebase/firestore\";\nimport { db } from \"../firebase\";\nexport const sendMessage = async (fromId, toId, messageObj) => {\n  const userRef = db.collection(\"users\");\n  try {\n    const fromUser = await getUser(fromId);\n    const toUser = await getUser(toId);\n    if (!fromUser || !toUser) {\n      return false;\n    }\n    messageObj.timestamp = getTimestamp();\n    await updateUser(fromId, {\n      sentMessages: addMessage(fromUser.sentMessages, messageObj)\n    });\n    await updateUser(toId, {\n      mailbox: addMessage(toUser.mailbox, messageObj)\n    });\n    return true;\n  } catch (error) {\n    console.error(\"Error sending message: \", error);\n    return false;\n  }\n};\nconst getUser = async userId => {\n  const userDoc = await db.collection(\"users\").doc(userId).get();\n  return userDoc.exists ? userDoc.data() : null;\n};\nconst updateUser = async (userId, data) => {\n  await db.collection(\"users\").doc(userId).update(data);\n};\nconst addMessage = (messageList, messageObj) => {\n  return [...messageList, messageObj];\n};\nconst getTimestamp = () => {\n  return firebase.firestore.FieldValue.serverTimestamp();\n};","map":{"version":3,"names":["useRef","addDoc","collection","get","db","sendMessage","fromId","toId","messageObj","userRef","fromUser","getUser","toUser","timestamp","getTimestamp","updateUser","sentMessages","addMessage","mailbox","error","console","userId","userDoc","doc","exists","data","update","messageList","firebase","firestore","FieldValue","serverTimestamp"],"sources":["/Users/ndmx/Dev/adminpanel/admin/src/utils/mockDatabase.js"],"sourcesContent":["import { useRef } from \"react\";\nimport { addDoc, collection, get } from \"firebase/firestore\";\nimport { db } from \"../firebase\";\n\nexport const sendMessage = async (fromId, toId, messageObj) => {\n  const userRef = db.collection(\"users\");\n\n  try {\n    const fromUser = await getUser(fromId);\n    const toUser = await getUser(toId);\n\n    if (!fromUser || !toUser) {\n      return false;\n    }\n\n    messageObj.timestamp = getTimestamp();\n\n    await updateUser(fromId, {\n      sentMessages: addMessage(fromUser.sentMessages, messageObj),\n    });\n\n    await updateUser(toId, {\n      mailbox: addMessage(toUser.mailbox, messageObj),\n    });\n\n    return true;\n  } catch (error) {\n    console.error(\"Error sending message: \", error);\n    return false;\n  }\n};\n\nconst getUser = async (userId) => {\n  const userDoc = await db.collection(\"users\").doc(userId).get();\n  return userDoc.exists ? userDoc.data() : null;\n};\n\nconst updateUser = async (userId, data) => {\n  await db.collection(\"users\").doc(userId).update(data);\n};\n\nconst addMessage = (messageList, messageObj) => {\n  return [...messageList, messageObj];\n};\n\nconst getTimestamp = () => {\n  return firebase.firestore.FieldValue.serverTimestamp();\n};"],"mappings":"AAAA,SAASA,MAAM,QAAQ,OAAO;AAC9B,SAASC,MAAM,EAAEC,UAAU,EAAEC,GAAG,QAAQ,oBAAoB;AAC5D,SAASC,EAAE,QAAQ,aAAa;AAEhC,OAAO,MAAMC,WAAW,GAAG,MAAAA,CAAOC,MAAM,EAAEC,IAAI,EAAEC,UAAU,KAAK;EAC7D,MAAMC,OAAO,GAAGL,EAAE,CAACF,UAAU,CAAC,OAAO,CAAC;EAEtC,IAAI;IACF,MAAMQ,QAAQ,GAAG,MAAMC,OAAO,CAACL,MAAM,CAAC;IACtC,MAAMM,MAAM,GAAG,MAAMD,OAAO,CAACJ,IAAI,CAAC;IAElC,IAAI,CAACG,QAAQ,IAAI,CAACE,MAAM,EAAE;MACxB,OAAO,KAAK;IACd;IAEAJ,UAAU,CAACK,SAAS,GAAGC,YAAY,CAAC,CAAC;IAErC,MAAMC,UAAU,CAACT,MAAM,EAAE;MACvBU,YAAY,EAAEC,UAAU,CAACP,QAAQ,CAACM,YAAY,EAAER,UAAU;IAC5D,CAAC,CAAC;IAEF,MAAMO,UAAU,CAACR,IAAI,EAAE;MACrBW,OAAO,EAAED,UAAU,CAACL,MAAM,CAACM,OAAO,EAAEV,UAAU;IAChD,CAAC,CAAC;IAEF,OAAO,IAAI;EACb,CAAC,CAAC,OAAOW,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;IAC/C,OAAO,KAAK;EACd;AACF,CAAC;AAED,MAAMR,OAAO,GAAG,MAAOU,MAAM,IAAK;EAChC,MAAMC,OAAO,GAAG,MAAMlB,EAAE,CAACF,UAAU,CAAC,OAAO,CAAC,CAACqB,GAAG,CAACF,MAAM,CAAC,CAAClB,GAAG,CAAC,CAAC;EAC9D,OAAOmB,OAAO,CAACE,MAAM,GAAGF,OAAO,CAACG,IAAI,CAAC,CAAC,GAAG,IAAI;AAC/C,CAAC;AAED,MAAMV,UAAU,GAAG,MAAAA,CAAOM,MAAM,EAAEI,IAAI,KAAK;EACzC,MAAMrB,EAAE,CAACF,UAAU,CAAC,OAAO,CAAC,CAACqB,GAAG,CAACF,MAAM,CAAC,CAACK,MAAM,CAACD,IAAI,CAAC;AACvD,CAAC;AAED,MAAMR,UAAU,GAAGA,CAACU,WAAW,EAAEnB,UAAU,KAAK;EAC9C,OAAO,CAAC,GAAGmB,WAAW,EAAEnB,UAAU,CAAC;AACrC,CAAC;AAED,MAAMM,YAAY,GAAGA,CAAA,KAAM;EACzB,OAAOc,QAAQ,CAACC,SAAS,CAACC,UAAU,CAACC,eAAe,CAAC,CAAC;AACxD,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}